#pragma once

#include <cuda_runtime.h>

typedef int           vtype;

//
// Bitslice DES S-boxes with LOP3.LUT instructions
// For NVIDIA Maxwell architecture and CUDA 7.5 RC
// by DeepLearningJohnDoe, version 0.1.1, 2015/07/14
//
// Gate counts: 26 24 25 18 26 26 26 23
// Average: 24.25
// Depth: 8 7 7 6 7 7 6 8
// Average: 7
//
// Note that same S-box function with a lower gate count isn't necessarily faster.
//
// These Boolean expressions corresponding to DES S-boxes were
// discovered by <deeplearningjohndoe at gmail.com>
//
// This file itself is Copyright (c) 2015 by <deeplearningjohndoe at gmail.com>
// Redistribution and use in source and binary forms, with or without
// modification, are permitted.
//
// The underlying mathematical formulas are NOT copyrighted.
//

#define LUT(a,b,c,d,e) vtype a; asm("lop3.b32 %0, %1, %2, %3, "#e";" : "=r"(##a): "r"(##b), "r"(##c), "r"(##d));

__device__ __forceinline__ void
s1(vtype a1, vtype a2, vtype a3, vtype a4, vtype a5, vtype a6,
vtype * out1, vtype * out2, vtype * out3, vtype * out4)
{
	LUT(xAA55AA55AA55AA55, a1, a1, a4, 0xA5)
		LUT(xA55AA55AF0F0F0F0, a3, a6, xAA55AA55AA55AA55, 0x1E)
		LUT(x05500550FAFAFAFA, a1, a6, xA55AA55AF0F0F0F0, 0xAC)
		LUT(x50FA50FA55AF55AF, a6, xAA55AA55AA55AA55, x05500550FAFAFAFA, 0x79)
		LUT(xF5A0A55AA55FF0F0, a5, xA55AA55AF0F0F0F0, x50FA50FA55AF55AF, 0xC6)
		LUT(xAA0555FA0005FFFA, a5, xAA55AA55AA55AA55, x05500550FAFAFAFA, 0xB4)
		LUT(x5FFFAA5FFFFF5AA5, x50FA50FA55AF55AF, xF5A0A55AA55FF0F0, xAA0555FA0005FFFA, 0xD7)
		LUT(x3, a2, xF5A0A55AA55FF0F0, x5FFFAA5FFFFF5AA5, 0xC6)
		LUT(x5555000055550000, a1, a1, a5, 0x7C)
		LUT(xF5F5F5F5A5A5A5A5, a1, a3, a6, 0xD3)
		LUT(xF5AAF5FFF5FAA5FF, a4, x5555000055550000, xF5F5F5F5A5A5A5A5, 0x7E)
		LUT(xFA05FA50FF00AF05, a1, x50FA50FA55AF55AF, xF5AAF5FFF5FAA5FF, 0x93)
		LUT(x55AAFFAFAF5F0005, a3, xF5A0A55AA55FF0F0, xAA0555FA0005FFFA, 0xD6)
		LUT(x5050FFA0AFA050FF, x5FFFAA5FFFFF5AA5, xFA05FA50FF00AF05, x55AAFFAFAF5F0005, 0x9B)
		LUT(x1, a2, xF5AAF5FFF5FAA5FF, x5050FFA0AFA050FF, 0xA6)
		LUT(xAA50AA05AA50AA05, a1, a4, xAA0555FA0005FFFA, 0x43)
		LUT(xA5FA0F5F5AFFF0F5, xF5A0A55AA55FF0F0, xAA0555FA0005FFFA, xFA05FA50FF00AF05, 0xD3)
		LUT(x05AA5AA550AFA50F, a5, xAA50AA05AA50AA05, xA5FA0F5F5AFFF0F5, 0x92)
		LUT(xA550A550AFAFAFAF, a6, xA55AA55AF0F0F0F0, xF5F5F5F5A5A5A5A5, 0xB8)
		LUT(xFAFF50FF0AF5FFAA, xF5AAF5FFF5FAA5FF, x55AAFFAFAF5F0005, xA550A550AFAFAFAF, 0x6B)
		LUT(x4, a2, x05AA5AA550AFA50F, xFAFF50FF0AF5FFAA, 0x6C)
		LUT(x50F050A0AA50AA00, a3, x05500550FAFAFAFA, xAA50AA05AA50AA05, 0x89)
		LUT(xAF55FFFA0F0F5AF0, xF5A0A55AA55FF0F0, xF5AAF5FFF5FAA5FF, x50F050A0AA50AA00, 0x7B)
		LUT(x5AA50000F0F0FFFF, a5, a6, xA55AA55AF0F0F0F0, 0xC9)
		LUT(x5AA550FA50A5AA55, x50FA50FA55AF55AF, xAA0555FA0005FFFA, x5AA50000F0F0FFFF, 0x68)
		LUT(x2, a2, xAF55FFFA0F0F5AF0, x5AA550FA50A5AA55, 0xA6)

		*out1 ^= x1;
	*out2 ^= x2;
	*out3 ^= x3;
	*out4 ^= x4;
}

__device__ __forceinline__ void
s2(vtype a1, vtype a2, vtype a3, vtype a4, vtype a5, vtype a6,
vtype * out1, vtype * out2, vtype * out3, vtype * out4)
{
	LUT(xEEEEEEEE99999999, a1, a2, a6, 0x97)
		LUT(xFFFFEEEE66666666, a5, a6, xEEEEEEEE99999999, 0x67)
		LUT(x5555FFFFFFFF0000, a1, a5, a6, 0x76)
		LUT(x6666DDDD5555AAAA, a2, xFFFFEEEE66666666, x5555FFFFFFFF0000, 0x69)
		LUT(x6969D3D35353ACAC, a3, xFFFFEEEE66666666, x6666DDDD5555AAAA, 0x6A)
		LUT(xCFCF3030CFCF3030, a2, a3, a5, 0x65)
		LUT(xE4E4EEEE9999F0F0, a3, xEEEEEEEE99999999, x5555FFFFFFFF0000, 0x8D)
		LUT(xE5E5BABACDCDB0B0, a1, xCFCF3030CFCF3030, xE4E4EEEE9999F0F0, 0xCA)
		LUT(x3, a4, x6969D3D35353ACAC, xE5E5BABACDCDB0B0, 0xC6)
		LUT(x3333CCCC00000000, a2, a5, a6, 0x14)
		LUT(xCCCCDDDDFFFF0F0F, a5, xE4E4EEEE9999F0F0, x3333CCCC00000000, 0xB5)
		LUT(x00000101F0F0F0F0, a3, a6, xFFFFEEEE66666666, 0x1C)
		LUT(x9A9A64646A6A9595, a1, xCFCF3030CFCF3030, x00000101F0F0F0F0, 0x96)
		LUT(x2, a4, xCCCCDDDDFFFF0F0F, x9A9A64646A6A9595, 0x6A)
		LUT(x3333BBBB3333FFFF, a1, a2, x6666DDDD5555AAAA, 0xDE)
		LUT(x1414141441410000, a1, a3, xE4E4EEEE9999F0F0, 0x90)
		LUT(x7F7FF3F3F5F53939, x6969D3D35353ACAC, x9A9A64646A6A9595, x3333BBBB3333FFFF, 0x79)
		LUT(x9494E3E34B4B3939, a5, x1414141441410000, x7F7FF3F3F5F53939, 0x29)
		LUT(x1, a4, x3333BBBB3333FFFF, x9494E3E34B4B3939, 0xA6)
		LUT(xB1B1BBBBCCCCA5A5, a1, a1, xE4E4EEEE9999F0F0, 0x4A)
		LUT(xFFFFECECEEEEDDDD, a2, x3333CCCC00000000, x9A9A64646A6A9595, 0xEF)
		LUT(xB1B1A9A9DCDC8787, xE5E5BABACDCDB0B0, xB1B1BBBBCCCCA5A5, xFFFFECECEEEEDDDD, 0x8D)
		LUT(xFFFFCCCCEEEE4444, a2, a5, xFFFFEEEE66666666, 0x2B)
		LUT(x4, a4, xB1B1A9A9DCDC8787, xFFFFCCCCEEEE4444, 0x6C)

		*out1 ^= x1;
	*out2 ^= x2;
	*out3 ^= x3;
	*out4 ^= x4;
}

__device__ __forceinline__ void
s3(vtype a1, vtype a2, vtype a3, vtype a4, vtype a5, vtype a6,
vtype * out1, vtype * out2, vtype * out3, vtype * out4)
{
	LUT(xA50FA50FA50FA50F, a1, a3, a4, 0xC9)
		LUT(xF0F00F0FF0F0F0F0, a3, a5, a6, 0x4B)
		LUT(xAF0FA0AAAF0FAF0F, a1, xA50FA50FA50FA50F, xF0F00F0FF0F0F0F0, 0x4D)
		LUT(x5AA5A55A5AA55AA5, a1, a4, xF0F00F0FF0F0F0F0, 0x69)
		LUT(xAA005FFFAA005FFF, a3, a5, xA50FA50FA50FA50F, 0xD6)
		LUT(x5AA5A55A0F5AFAA5, a6, x5AA5A55A5AA55AA5, xAA005FFFAA005FFF, 0x9C)
		LUT(x1, a2, xAF0FA0AAAF0FAF0F, x5AA5A55A0F5AFAA5, 0xA6)
		LUT(xAA55AA5500AA00AA, a1, a4, a6, 0x49)
		LUT(xFAFAA50FFAFAA50F, a1, a5, xA50FA50FA50FA50F, 0x9B)
		LUT(x50AF0F5AFA50A5A5, a1, xAA55AA5500AA00AA, xFAFAA50FFAFAA50F, 0x66)
		LUT(xAFAFAFAFFAFAFAFA, a1, a3, a6, 0x6F)
		LUT(xAFAFFFFFFFFAFAFF, a4, x50AF0F5AFA50A5A5, xAFAFAFAFFAFAFAFA, 0xEB)
		LUT(x4, a2, x50AF0F5AFA50A5A5, xAFAFFFFFFFFAFAFF, 0x6C)
		LUT(x500F500F500F500F, a1, a3, a4, 0x98)
		LUT(xF0505A0505A5050F, x5AA5A55A0F5AFAA5, xAA55AA5500AA00AA, xAFAFAFAFFAFAFAFA, 0x1D)
		LUT(xF0505A05AA55AAFF, a6, x500F500F500F500F, xF0505A0505A5050F, 0x9A)
		LUT(xFF005F55FF005F55, a1, a4, xAA005FFFAA005FFF, 0xB2)
		LUT(xA55F5AF0A55F5AF0, a5, xA50FA50FA50FA50F, x5AA5A55A5AA55AA5, 0x3D)
		LUT(x5A5F05A5A55F5AF0, a6, xFF005F55FF005F55, xA55F5AF0A55F5AF0, 0xA6)
		LUT(x3, a2, xF0505A05AA55AAFF, x5A5F05A5A55F5AF0, 0xA6)
		LUT(x0F0F0F0FA5A5A5A5, a1, a3, a6, 0xC6)
		LUT(x5FFFFF5FFFA0FFA0, x5AA5A55A5AA55AA5, xAFAFAFAFFAFAFAFA, x0F0F0F0FA5A5A5A5, 0xDB)
		LUT(xF5555AF500A05FFF, a5, xFAFAA50FFAFAA50F, xF0505A0505A5050F, 0xB9)
		LUT(x05A5AAF55AFA55A5, xF0505A05AA55AAFF, x0F0F0F0FA5A5A5A5, xF5555AF500A05FFF, 0x9B)
		LUT(x2, a2, x5FFFFF5FFFA0FFA0, x05A5AAF55AFA55A5, 0xA6)

		*out1 ^= x1;
	*out2 ^= x2;
	*out3 ^= x3;
	*out4 ^= x4;
}

__device__ __forceinline__ void
s4(vtype a1, vtype a2, vtype a3, vtype a4, vtype a5, vtype a6,
vtype * out1, vtype * out2, vtype * out3, vtype * out4)
{
	LUT(x55F055F055F055F0, a1, a3, a4, 0x72)
		LUT(xA500F5F0A500F5F0, a3, a5, x55F055F055F055F0, 0xAD)
		LUT(xF50AF50AF50AF50A, a1, a3, a4, 0x59)
		LUT(xF5FA0FFFF5FA0FFF, a3, a5, xF50AF50AF50AF50A, 0xE7)
		LUT(x61C8F93C61C8F93C, a2, xA500F5F0A500F5F0, xF5FA0FFFF5FA0FFF, 0xC6)
		LUT(x9999666699996666, a1, a2, a5, 0x69)
		LUT(x22C022C022C022C0, a2, a4, x55F055F055F055F0, 0x18)
		LUT(xB35C94A6B35C94A6, xF5FA0FFFF5FA0FFF, x9999666699996666, x22C022C022C022C0, 0x63)
		LUT(x4, a6, x61C8F93C61C8F93C, xB35C94A6B35C94A6, 0x6A)
		LUT(x4848484848484848, a1, a2, a3, 0x12)
		LUT(x55500AAA55500AAA, a1, a5, xF5FA0FFFF5FA0FFF, 0x28)
		LUT(x3C90B3D63C90B3D6, x61C8F93C61C8F93C, x4848484848484848, x55500AAA55500AAA, 0x1E)
		LUT(x8484333384843333, a1, x9999666699996666, x4848484848484848, 0x14)
		LUT(x4452F1AC4452F1AC, xF50AF50AF50AF50A, xF5FA0FFFF5FA0FFF, xB35C94A6B35C94A6, 0x78)
		LUT(x9586CA379586CA37, x55500AAA55500AAA, x8484333384843333, x4452F1AC4452F1AC, 0xD6)
		LUT(x2, a6, x3C90B3D63C90B3D6, x9586CA379586CA37, 0x6A)
		LUT(x1, a6, x3C90B3D63C90B3D6, x9586CA379586CA37, 0xA9)
		LUT(x3, a6, x61C8F93C61C8F93C, xB35C94A6B35C94A6, 0x56)

		*out1 ^= x1;
	*out2 ^= x2;
	*out3 ^= x3;
	*out4 ^= x4;
}

__device__ __forceinline__ void
s5(vtype a1, vtype a2, vtype a3, vtype a4, vtype a5, vtype a6,
vtype * out1, vtype * out2, vtype * out3, vtype * out4)
{
	LUT(x5A555A555A555A55, a1, a3, a4, 0xB4)
		LUT(xF5FAF5FA5A555A55, a3, a6, x5A555A555A555A55, 0x9B)
		LUT(x50A550A550A550A5, a1, a3, a4, 0x92)
		LUT(xAF5AAF5AF0F0F0F0, a3, a6, x50A550A550A550A5, 0x1D)
		LUT(x5AA0F5FAAAA55A55, a5, xF5FAF5FA5A555A55, xAF5AAF5AF0F0F0F0, 0xC6)
		LUT(xF00AF00AF00AF00A, a1, a3, a4, 0x19)
		LUT(x00FF00FFFFAAFFAA, a1, a4, a6, 0x6E)
		LUT(xA0F5A0F50FA50FA5, x50A550A550A550A5, xF00AF00AF00AF00A, x00FF00FFFFAAFFAA, 0x36)
		LUT(x50FFF00AFFAFF00A, a5, xF00AF00AF00AF00A, xA0F5A0F50FA50FA5, 0xC6)
		LUT(x4, a2, x5AA0F5FAAAA55A55, x50FFF00AFFAFF00A, 0xC6)
		LUT(x05FF05FF5AFF5AFF, a1, a4, xAF5AAF5AF0F0F0F0, 0xED)
		LUT(x0F000A000F000A00, a1, a5, x5A555A555A555A55, 0x1A)
		LUT(x50A5AA0A0F0FA0A0, a1, a5, xAF5AAF5AF0F0F0F0, 0x19)
		LUT(x5F5AA0F5F0A5550A, x00FF00FFFFAAFFAA, x0F000A000F000A00, x50A5AA0A0F0FA0A0, 0x16)
		LUT(x2, a2, x05FF05FF5AFF5AFF, x5F5AA0F5F0A5550A, 0xA6)
		LUT(xA05050A0A05050A0, a3, a5, x50A550A550A550A5, 0x09)
		LUT(xA5005F0555A0FA0A, a4, xF5FAF5FA5A555A55, x50A5AA0A0F0FA0A0, 0x16)
		LUT(xFA5A50AF05AA5AF0, xA0F5A0F50FA50FA5, xA05050A0A05050A0, xA5005F0555A0FA0A, 0xE9)
		LUT(xA5505A0555F0F0AA, a3, x5AA0F5FAAAA55A55, xA5005F0555A0FA0A, 0x2B)
		LUT(xFF50FFFAF5F0AF55, a5, x05FF05FF5AFF5AFF, xA5505A0555F0F0AA, 0x7B)
		LUT(x1, a2, xFA5A50AF05AA5AF0, xFF50FFFAF5F0AF55, 0xC6)
		LUT(xAF00550FF00A5F05, a3, xF00AF00AF00AF00A, x50A5AA0A0F0FA0A0, 0x94)
		LUT(x55AA05A55FA050AF, a1, x05FF05FF5AFF5AFF, xAF00550FF00A5F05, 0x94)
		LUT(xAF5A5FF5F0FAFFFF, a1, xF5FAF5FA5A555A55, x50A5AA0A0F0FA0A0, 0x57)
		LUT(xFAA55FFFAF05FFFF, a5, x05FF05FF5AFF5AFF, xAF5A5FF5F0FAFFFF, 0xE7)
		LUT(x3, a2, x55AA05A55FA050AF, xFAA55FFFAF05FFFF, 0xC6)

		*out1 ^= x1;
	*out2 ^= x2;
	*out3 ^= x3;
	*out4 ^= x4;
}

__device__ __forceinline__ void
s6(vtype a1, vtype a2, vtype a3, vtype a4, vtype a5, vtype a6,
vtype * out1, vtype * out2, vtype * out3, vtype * out4)
{
	LUT(xAA5555AAAA5555AA, a1, a4, a5, 0x69)
		LUT(xEE88EE88EE88EE88, a1, a2, a4, 0x17)
		LUT(xEE88FFDDEE88FFDD, a1, a5, xEE88EE88EE88EE88, 0xEA)
		LUT(xAA5555AA44DDAA77, a6, xAA5555AAAA5555AA, xEE88FFDDEE88FFDD, 0x6C)
		LUT(x6699333366993333, a2, a5, xAA5555AAAA5555AA, 0xE1)
		LUT(xDDFF3311DDFF3311, a2, a5, xEE88FFDDEE88FFDD, 0x97)
		LUT(x66993333DDFF3311, a6, x6699333366993333, xDDFF3311DDFF3311, 0xAC)
		LUT(x1, a3, xAA5555AA44DDAA77, x66993333DDFF3311, 0xC6)
		LUT(xEEEE9999EEEE9999, a1, a2, a5, 0x97)
		LUT(x11EE449911EE4499, a1, a4, xEEEE9999EEEE9999, 0x98)
		LUT(xBB44DDBBBB44DDBB, a5, xAA5555AAAA5555AA, xEEEE9999EEEE9999, 0xE9)
		LUT(x11EE4499BB44DDBB, a6, x11EE449911EE4499, xBB44DDBBBB44DDBB, 0xAC)
		LUT(x7777777722222222, a1, a2, a6, 0x5C)
		LUT(x7777EEEE2222FFFF, a5, xEEEE9999EEEE9999, x7777777722222222, 0x7A)
		LUT(x3, a3, x11EE4499BB44DDBB, x7777EEEE2222FFFF, 0x6C)
		LUT(x9944CC999944CC99, a2, xAA5555AAAA5555AA, xBB44DDBBBB44DDBB, 0x2A)
		LUT(xBBAAFF88BBAAFF88, a1, xAA5555AAAA5555AA, xEE88FFDDEE88FFDD, 0x9B)
		LUT(x22EE33119944CC99, a6, x9944CC999944CC99, xBBAAFF88BBAAFF88, 0xC6)
		LUT(x11CC555544994444, a1, x6699333366993333, x7777EEEE2222FFFF, 0x64)
		LUT(xBBBB55FFFFEE55EE, xAA5555AAAA5555AA, xEE88FFDDEE88FFDD, x11CC555544994444, 0xDB)
		LUT(x2, a3, x22EE33119944CC99, xBBBB55FFFFEE55EE, 0xC6)
		LUT(xFF77FF6655FF6666, xEE88FFDDEE88FFDD, xEEEE9999EEEE9999, x11EE4499BB44DDBB, 0x7F)
		LUT(x5566AACC1133EE11, xAA5555AA44DDAA77, xBBBB55FFFFEE55EE, xFF77FF6655FF6666, 0x7B)
		LUT(xDD11CCEE9944CC88, a6, x6699333366993333, x22EE33119944CC99, 0x25)
		LUT(xCC1599AADDDD88C8, x3, x11CC555544994444, xDD11CCEE9944CC88, 0x26)
		LUT(x4, a3, x5566AACC1133EE11, xCC1599AADDDD88C8, 0x6C)


		*out1 ^= x1;
	*out2 ^= x2;
	*out3 ^= x3;
	*out4 ^= x4;
}

__device__ __forceinline__ void
s7(vtype a1, vtype a2, vtype a3, vtype a4, vtype a5, vtype a6,
vtype * out1, vtype * out2, vtype * out3, vtype * out4)
{
	LUT(xFFFFF00FFFFFF00F, a3, a4, a5, 0xD7)
		LUT(x0F0F00000000FFFF, a3, a5, a6, 0x98)
		LUT(xF00FF0F0FF0000FF, a4, xFFFFF00FFFFFF00F, x0F0F00000000FFFF, 0xB4)
		LUT(x3CC330FC33CCC0F3, a2, xFFFFF00FFFFFF00F, xF00FF0F0FF0000FF, 0xA6)
		LUT(x0FFF0FFF00FF00FF, a3, a4, a6, 0xDC)
		LUT(xFF00FF000FF00FF0, a3, a4, a6, 0x39)
		LUT(x00F0FF00F00F0FF0, a5, x0F0F00000000FFFF, xFF00FF000FF00FF0, 0xA1)
		LUT(x0C3CF3CCF0C30F3C, a2, x0FFF0FFF00FF00FF, x00F0FF00F00F0FF0, 0xA6)
		LUT(x1, a1, x3CC330FC33CCC0F3, x0C3CF3CCF0C30F3C, 0xCA)
		LUT(x00FF0F0FF00FF00F, a6, xFFFFF00FFFFFF00F, xFF00FF000FF00FF0, 0x46)
		LUT(xF00FFF00FF00FFFF, a4, a5, x0F0F00000000FFFF, 0xAD)
		LUT(x30FC3C0FC30FC33C, a2, x00FF0F0FF00FF00F, xF00FFF00FF00FFFF, 0x6C)
		LUT(x000FFFFF000F00F0, a4, a6, x00F0FF00F00F0FF0, 0x92)
		LUT(x0C3FFFFFF0CFF0F3, a5, x0C3CF3CCF0C30F3C, x000FFFFF000F00F0, 0xBE)
		LUT(x3, a1, x30FC3C0FC30FC33C, x0C3FFFFFF0CFF0F3, 0xC6)
		LUT(xF0FF0FF00FF0F00F, a6, xF00FF0F0FF0000FF, x00F0FF00F00F0FF0, 0x56)
		LUT(xF0F0F0F0FFFF00FF, a4, a5, xF00FF0F0FF0000FF, 0x9A)
		LUT(xC0CF3FC03CC3F03C, a2, xF0FF0FF00FF0F00F, xF0F0F0F0FFFF00FF, 0x6C)
		LUT(xFFFFFFFFCC33CCCC, a2, a6, xF00FFF00FF00FFFF, 0x7B)
		LUT(x3F30C03FC0FC3FC0, xF00FF0F0FF0000FF, xC0CF3FC03CC3F03C, xFFFFFFFFCC33CCCC, 0x27)
		LUT(x4, a1, xC0CF3FC03CC3F03C, x3F30C03FC0FC3FC0, 0xCA)
		LUT(x0C3CF3CC0F3CFF33, a6, xFFFFF00FFFFFF00F, x0C3CF3CCF0C30F3C, 0x6A)
		LUT(xC33FC3303FF03FCC, x3CC330FC33CCC0F3, x0C3FFFFFF0CFF0F3, x0C3CF3CC0F3CFF33, 0x6B)
		LUT(xCCFCCCFCCCFCCCFC, a2, a3, a4, 0x2F)
		LUT(x0C3CF3CCC3C03C3F, a6, x0C3CF3CCF0C30F3C, xCCFCCCFCCCFCCCFC, 0x9C)
		LUT(x2, a1, xC33FC3303FF03FCC, x0C3CF3CCC3C03C3F, 0xA6)


		*out1 ^= x1;
	*out2 ^= x2;
	*out3 ^= x3;
	*out4 ^= x4;
}

__device__ __forceinline__ void
s8(vtype a1, vtype a2, vtype a3, vtype a4, vtype a5, vtype a6,
vtype * out1, vtype * out2, vtype * out3, vtype * out4)
{
	LUT(xEEEE3333EEEE3333, a1, a2, a5, 0x9D)
		LUT(xBBBBBBBBBBBBBBBB, a1, a1, a2, 0x83)
		LUT(xDDDDAAAADDDDAAAA, a1, a2, a5, 0x5B)
		LUT(x29295A5A29295A5A, a3, xBBBBBBBBBBBBBBBB, xDDDDAAAADDDDAAAA, 0x85)
		LUT(xC729695AC729695A, a4, xEEEE3333EEEE3333, x29295A5A29295A5A, 0xA6)
		LUT(x3BF77B7B3BF77B7B, a2, a5, xC729695AC729695A, 0xF9)
		LUT(x2900FF002900FF00, a4, a5, x29295A5A29295A5A, 0x0E)
		LUT(x56B3803F56B3803F, xBBBBBBBBBBBBBBBB, x3BF77B7B3BF77B7B, x2900FF002900FF00, 0x61)
		LUT(x4, a6, xC729695AC729695A, x56B3803F56B3803F, 0x6C)
		LUT(xFBFBFBFBFBFBFBFB, a1, a2, a3, 0xDF)
		LUT(x3012B7B73012B7B7, a2, a5, xC729695AC729695A, 0xD4)
		LUT(x34E9B34C34E9B34C, a4, xFBFBFBFBFBFBFBFB, x3012B7B73012B7B7, 0x69)
		LUT(xBFEAEBBEBFEAEBBE, a1, x29295A5A29295A5A, x34E9B34C34E9B34C, 0x6F)
		LUT(xFFAEAFFEFFAEAFFE, a3, xBBBBBBBBBBBBBBBB, xBFEAEBBEBFEAEBBE, 0xB9)
		LUT(x2, a6, x34E9B34C34E9B34C, xFFAEAFFEFFAEAFFE, 0xC6)
		LUT(xCFDE88BBCFDE88BB, a2, xDDDDAAAADDDDAAAA, x34E9B34C34E9B34C, 0x5C)
		LUT(x3055574530555745, a1, xC729695AC729695A, xCFDE88BBCFDE88BB, 0x71)
		LUT(x99DDEEEE99DDEEEE, a4, xBBBBBBBBBBBBBBBB, xDDDDAAAADDDDAAAA, 0xB9)
		LUT(x693CD926693CD926, x3BF77B7B3BF77B7B, x34E9B34C34E9B34C, x99DDEEEE99DDEEEE, 0x69)
		LUT(x3, a6, x3055574530555745, x693CD926693CD926, 0x6A)
		LUT(x9955EE559955EE55, a1, a4, x99DDEEEE99DDEEEE, 0xE2)
		LUT(x9D48FA949D48FA94, x3BF77B7B3BF77B7B, xBFEAEBBEBFEAEBBE, x9955EE559955EE55, 0x9C)
		LUT(x1, a6, xC729695AC729695A, x9D48FA949D48FA94, 0x39)


		*out1 ^= x1;
	*out2 ^= x2;
	*out3 ^= x3;
	*out4 ^= x4;
}